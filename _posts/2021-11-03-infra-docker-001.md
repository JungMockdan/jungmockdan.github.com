---
title: "따배도 복습- 도커"
date: 2021-07-20 13:26:28 -0400
categories: docker
tags: docker


# 목차
toc: true  
toc_sticky: true
---

본 게시물은 유투브 강의 따배도-도커 강의를 보고 학습한 내용을 정리한 내용입니다.

[따배도 강의 바로가기](https://www.youtube.com/channel/UC_VOQjI7mtQTEaTXXQIzLtQ)

## 1. 컨테이너와 도커의 이해

### why we should learn it?
- 필요하기 때문에 시대적 요구 : 하드웨어 가격 다운, 성능 높아지고, 서비스는 커지고 무거워져
- 시스템이 커지면서 오토스케일이나 무중단배포등이 필요해졌다.
  - 용량이 적은 컨테이너 어플리케이션이 이것을 충족한다.
- 컨테이너가 환경을 다 갖추고 있다 : 컨테이너단위로. 독립. isolation

### 리눅스위에서 돌리는 이유
- 리눅스 커널이 컨테이너에 필요한 설정을 모두 제공하고 있다.
  - 스토리지
  - 네임스페이스 : isolation
  - 네트워킹
- mac이나 windows에서는 hypervisor 기능을 활성화 해야 한다.
- 결론적으로 돈안주고 리눅스커널위에 따로 기능활성화 없이 바로 컨테이너 사용할 수 있는 리눅스가 된다.

### 그냥 프로그램 구동과 다른 점.
- e.g 

### 쓰는 이유
- 오토스케일 가능(msa 구조에 유리)
- 데브옵스 적합
- 개발환경,운영환경 차이로 인한 어려움이 없다. 컨테이너 채로 설치하면 됨.
- 기존에서는 스케일업하려면 모든 환경을 복제해야 하지만, 컨테이너구조에서 컨테이너만 복제하면 됨.

## 2. 도커 설치실습
- 아래 케이스에 맞게 설치하면 된다.

### 2.1. Virtualbox 환경
- 윈도우 환경에서 hypervisor를 설치하고 hypervisor 내부의 가상머신 2대를 설치한후 각 각의 가상머신에 docker를 설치한다.

1) Virtualbox(hypervisor 중에 하나) 다운로드 :arrow_left: 설치
2) Virtualbox 네트워크구성(vm간/외부)

#### 2.1.1. Virtualbox 내 가상머신(vm) 만들기
- ubuntu 와 centOS 2개를 만들었음.
- ubuntu 가상머신에 우분투이미지 연결 (본격 설치 임.)
  - ubuntu 가상머신에 우분투20.04LTS 버전을 다운받아. 
  - 설정>저장소> 컨트롤러 IDE에 다운받은 우분투 설치 파일을 등록한다. 
  - 시작하기 하면 설치 진행됨. 리부팅하기
  - 설치 후 환경구성
    - ubuntu 가상머신을 시작하면 최초설치에 따른 설정선택이 진행되고 구동된다. 
    - gui 로그인
    - 서버구성 : 네트워크 설정
    - text 부팅으로 수정
    - root password 설정 : sudo passwd root - 나의패스워드
    - 터미널에서 host, hostname 등 설정
    - ssh 서버 어플리케이션 설치 : 그 외 필요한 것
      - `apt-get update && apt-get install -y openssh-server curl vim tree`
      - ssh 툴로 로그인 구성 ( 윈도우(로컬) 터미널에서도 가상머신에 접속가능해짐)
  - 스냅샷 찍기 : 최초 상태로 돌아갈 수 있는 포인트를 만듦
- centOS 가상머신에 우분투이미지 연결 (본격 설치 임)
  - 웹에서 다운받아 설정>저장소> 컨트롤러 IDE에 다운받은 centOS 설치 파일을 등록
  - 시작하기 하면 설치 진행됨. 
  - 설치 후 환경구성
    - centOS 가상머신을 시작하면 최초설치에 따른 설정선택이 진행되고 구동된다.
    - 서버구성 : 네트워크 설정
    - root 패스워드 설정하기
    - 사용자등록
    - 리부팅 후 라이센스동의(필수), 환경구성 추가 설정(옵션).
    - gui 로그인, 환경구성 추가 설정
    - 네트워크 설정 확인
    - 터미널에서 host, hostname 등 설정
    - reboot
    - ssh 이미 설치 되어있음. 
      - ssh 툴로 로그인 구성 ( 윈도우(로컬) 터미널에서도 가상머신에 접속가능해짐)
  - 스냅샷 찍기 : 최초 상태로 돌아갈 수 있는 포인트를 만듦
  
#### 2.1.2. 가상머신에 도커설치하기
- 준비 1. 가상머신 구동 그리고 ssh툴로 각각 연결해둘 것.
- 도커 문서 `https://docs.docker.com`
- docker for linux
- 설치 방법의 종류 : 레파지토리 이용/다운로드 직접/script 이용 설치
- Repository를 이용한 설치

##### 2.1.2.1. 우분투에 설치하기([도커공식문서보기 :link:](https://docs.docker.com/engine/install/ubuntu/) )
- apt 패키지인덱스를 업데이트 하고 apt가 https를 통해 레파지토리를 사용하도록 허락하는 패키지를 설치.
  ```shell
  $ sudo apt-get update
  $ sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

  ```
- 도커 인증서 저장
  ```shell
  $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
  ```
- 설치할 안정적인 저장소의 URL 등록
  ```shell
  $  echo \ 
  "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
  ```
- 도커 설치
  ```shell
  $ sudo apt-get update
  $ sudo apt-get install docker-ce docker-ce-cli containerd.io -y
  ```
  - 도커 설치 확인
    ```shell
    $ sudo docker version
    ```  
    
##### 2.1.2.2. centOS에 설치하기([도커공식문서보기 :link:](https://docs.docker.com/engine/install/centos/) )
- 레파지토리 셋업 : yum-utils 패키지 설치와 안정적인 버전의 도커 레파지토리 설정
  ```shell
  $ su - // root 로 변경
  $ yum install -y yum-utils
  $ yum-config-manager \
      --add-repo \
      https://download.docker.com/linux/centos/docker-ce.repo
  ```  
- 도커 설치
  ```shell
  $ sudo yum install docker-ce docker-ce-cli containerd.io -y
  ``` 
- 도커 구동(서비스데몬실행) 및 확인
  ```shell
  $ systemctl start docker
  $ docker version
  ``` 
###### 유저에게 도커 명령어를 쓸수 있도록 도커관리자 권한 부여하고 확인하기(Linux계열 동일)
  ```shell
  $ su -
  $ usermod -a -G docker 유저id
  $ su - 유저id
  $ docker ps
  ``` 
### 2-5. windows (dockerDesktop) 


## 3. 도커 컨테이너 살펴보기

### 3-1. 이롬

### 3-2. 실습

## 4. 도커 컨테이너 만들어보기

### 4-1. 이롬

### 4-2. 실습

## 5. 컨테이너 보관창고

### 5-1. 이론

### 5-2. 실습

## 6. Docker 컨테이너 사용하기

### 6-1. 이론

### 6-2. 실습

## 7. Docker 컨테이너 리소스 관리

### 7-1. 이론

### 7-2. 실습

## 8. Docker 컨테이너 스토리지 관리

### 8-1. 이론

### 8-2. 실습

## 9. Docker 컨테이너 간 통신

### 9-1. 이론

### 9-2. 실습

## 10. 빌드에서 운영까지

### 10-1. 이론

### 10-2. 실습

